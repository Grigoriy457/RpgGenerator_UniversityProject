{% extends "base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è | –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä RPG{% endblock %}

{% block content %}

<!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–ª–æ–∫ -->
<section class="hero">
  <div class="container">
    <h1 class="display-4 fw-bold">–°–æ–∑–¥–∞–≤–∞–π. –ò–≥—Ä–∞–π. –î–µ–ª–∏—Å—å.</h1>
    <p class="lead">–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ω–∞—Å—Ç–æ–ª—å–Ω—ã—Ö –∏ —Ä–æ–ª–µ–≤—ã—Ö –∏–≥—Ä —Å –ø–æ–ª–Ω–æ–π —Å–≤–æ–±–æ–¥–æ–π. –°–æ–∑–¥–∞–≤–∞–π –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, –ø—Ä–∞–≤–∏–ª–∞, –∏ —Å–≤–æ–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –º–∏—Ä—ã.</p>
    <a href="/games" class="btn btn-primary btn-lg mt-3">–ù–∞—á–∞—Ç—å</a>
  </div>
</section>

<!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ -->
<section class="py-5">
  <div class="container">
    <div class="row text-center">
      <div class="col-md-4">
        <div class="feature-icon mb-3">üé≤</div>
        <h5>–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å</h5>
        <p>–°–æ–∑–¥–∞–≤–∞–π –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫—É–±–∏–∫–∏, –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è. –í—Å—ë ‚Äî –≤ –æ–¥–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ.</p>
      </div>
      <div class="col-md-4">
        <div class="feature-icon mb-3">üßô</div>
        <h5>–ì–∏–±–∫–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∏</h5>
        <p>–ü—Ä–æ–µ–∫—Ç–∏—Ä—É–π –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –Ω–∞–≤—ã–∫–∞–º–∏, –∏–Ω–≤–µ–Ω—Ç–∞—Ä—ë–º –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.</p>
      </div>
      <div class="col-md-4">
        <div class="feature-icon mb-3">üåê</div>
        <h5>–°–æ–≤–º–µ—Å—Ç–Ω—ã–µ –∏–≥—Ä—ã</h5>
        <p>–ò–≥—Ä–∞–π –æ–Ω–ª–∞–π–Ω —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ –æ—Ñ—Ñ–ª–∞–π–Ω ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–π —Å–µ—Å—Å–∏–∏, –∑–∞–≥—Ä—É–∂–∞–π –∫–∞—Ä—Ç–æ—á–∫–∏.</p>
      </div>
    </div>
  </div>
</section>

<!-- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã -->
<style>
  .card {
    min-width: 300px;
    max-width: 300px; /* –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã –¥–ª—è —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏–∏ */
  }

  .card img {
    height: 200px; /* –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤—ã—Å–æ—Ç—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π */
    object-fit: cover; /* –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π */
  }

  .card-body {
    font-size: 1rem; /* –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ç–µ–∫—Å—Ç–∞ */
  }
</style>
<section class="py-5 bg-light">
  <div class="container">
    <h3 class="mb-4">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—ã</h3>
    <div class="mb-5">
      <div class="position-relative">
        <button class="btn btn-secondary position-absolute top-50 start-0 translate-middle-y" onclick="scroll_left(this)" style="z-index: 999">
          &#8249;
        </button>
        <div class="d-flex overflow-auto" id="popularGamesContainer">
          {% for game in popular_games %}
            <div class="card me-3 d-flex flex-column" style="min-width: 300px;">
              {% if game.image %}
                <img src="data:image/png;base64,{{ game.image_base64 }}" class="img-fluid rounded-start" alt="{{ game.title }}">
              {% else %}
                <div class="d-flex align-items-center justify-content-center bg-secondary text-white" style="width: 100%; height: 200px; object-fit: cover;">
                  <i class="bi bi-image" style="font-size: 2rem;"></i>
                  <span class="ms-2">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                </div>
              {% endif %}
              <div class="card-body d-flex flex-column">
                <h5 class="card-title d-flex justify-content-between align-items-center">
                  {{ game.title }}
                  <span class="text-muted ms-auto">
                    <i class="bi bi-eye"></i> {{ game.views }}
                  </span>
                </h5>
                <p class="card-text">{{ game.description | truncate(130) }}</p>
                <div class="d-flex justify-content-between align-items-center mt-auto">
                  <span class="text-muted">{{ game.created_at.strftime('%d.%m.%Y') }}</span>
                  <a href="/games/{{ game.id }}" class="btn btn-primary">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                </div>
              </div>
            </div>
          {% endfor %}
          <a href="/games/all" class="card me-3 d-flex flex-column justify-content-center align-items-center bg-secondary text-white text-decoration-none" style="min-width: 300px;">
            <div class="card-body d-flex justify-content-center align-items-center text-center">
              <h5 class="card-title display-6">–í–°–ï –ò–ì–†–´</h5>
            </div>
          </a>
        </div>
        <button class="btn btn-secondary position-absolute top-50 end-0 translate-middle-y" onclick="scroll_right(this)">
          &#8250;
        </button>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
  function scroll_left(button) {
    const container = button.parentElement.querySelector('.overflow-auto');
    const cards = container.querySelectorAll('.card');
    const containerScrollLeft = container.scrollLeft - container.offsetWidth;

    for (let i = 0; i < cards.length; i++) {
      const card = cards[i];
      if (card.offsetLeft + card.offsetWidth > containerScrollLeft) {
        cards[i].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
        break;
      }
    }
  }

  function scroll_right(button) {
    const container = button.parentElement.querySelector('.overflow-auto');
    const cards = container.querySelectorAll('.card');
    const containerScrollRight = container.scrollLeft + container.offsetWidth;

    for (let card of cards) {
      if (card.offsetLeft >= containerScrollRight) {
        card.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });
        break;
      }
    }
  }
</script>
{% endblock %}
